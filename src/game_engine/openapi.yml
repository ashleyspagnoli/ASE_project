openapi: 3.0.3
info:
  title: Game Engine API
  description: API for managing card game sessions, matchmaking, and gameplay logic.
  version: 1.0.0
servers:
  - url: http://localhost:5000
paths:
  /matchmaking/connect:
    post:
      summary: Connect a user to matchmaking
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_uuid:
                  type: string
                username:
                  type: string
      responses:
        '200':
          description: User connected
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  players_online_count:
                    type: integer
  /matchmaking/match:
    post:
      summary: Create a match between two online players
      responses:
        '200':
          description: Match created
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  game_id:
                    type: string
                  players:
                    type: array
                    items:
                      type: object
                      properties:
                        uuid:
                          type: string
                        name:
                          type: string
  /game/start:
    post:
      summary: Start a new game session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                player1_uuid:
                  type: string
                player1_name:
                  type: string
                player2_uuid:
                  type: string
                player2_name:
                  type: string
      responses:
        '200':
          description: Game started
          content:
            application/json:
              schema:
                type: object
                properties:
                  game_id:
                    type: string
  /game/{game_id}/deck:
    post:
      summary: Select a deck for a player in a game
      parameters:
        - name: game_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                player_uuid:
                  type: string
                deck_slot:
                  type: integer
      responses:
        '200':
          description: Deck selected
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
  /game/{game_id}/submit:
    post:
      summary: Submit a card for a player's turn
      parameters:
        - name: game_id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                player_uuid:
                  type: string
                card:
                  type: object
                  properties:
                    value:
                      type: string
                    suit:
                      type: string
      responses:
        '200':
          description: Turn resolved
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  message:
                    type: string
                  scores:
                    type: object
                  turn_number:
                    type: integer
                  match_winner:
                    type: string
  /game/{game_id}/state:
    get:
      summary: Get the current state of a game
      parameters:
        - name: game_id
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Game state
          content:
            application/json:
              schema:
                type: object
                properties:
                  game_id:
                    type: string
                  turn_number:
                    type: integer
                  winner:
                    type: string
                  scores:
                    type: object
                  players:
                    type: array
                    items:
                      type: object
                      properties:
                        uuid:
                          type: string
                        name:
                          type: string
                        hand_size:
                          type: integer
                  turn_history:
                    type: array
                    items:
                      type: object
  /game/{game_id}/hand/{player_uuid}:
    get:
      summary: Get the current hand of a player
      parameters:
        - name: game_id
          in: path
          required: true
          schema:
            type: string
        - name: player_uuid
          in: path
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Player hand
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    value:
                      type: string
                    suit:
                      type: string
  /validate-token:
    get:
      summary: Validate a user token
      parameters:
        - name: Authorization
          in: header
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Token valid
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  username:
                    type: string
        '401':
          description: Invalid token
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
